<!-- templates/home.html -->
{% extends 'versusfinder_app/base.html' %}

{% block title %}Search{% endblock %}

{% block content %}

<script>
    $( function() {
        $( "#slider-range" ).slider({
        range: true,
        min: 0,
        max: 10,
        values: [ 3, 7 ],
        slide: function( event, ui ) {
            $( "#amount" ).val(ui.values[ 0 ] + " - " + ui.values[ 1 ] );
        }
        });
        $( "#amount" ).val($( "#slider-range" ).slider( "values", 0 ) + " - " + $( "#slider-range" ).slider( "values", 1 ) );
        $( "#skill_min").val($( "#slider-range" ).slider( "values", 0 ))
        $( "#skill_max").val($( "#slider-range" ).slider( "values", 1 ))
    } );
</script>

{% if user.is_authenticated %}

    <div style="padding:30px">
        <div class="card">
            <div  class="card-header">
                <h2>Opponents lookup</h2>
            </div>
            <div class="card-body">

                <!-- Banlist button -->
                {% if gameprofile is not None %}
                <div style="padding: 10px 10px 50px 10px;">
                    <form action="{% url 'banlist.modify' user_id=user_id gameprofile_id=gameprofile.id %}" method="get">
                    <input class="btn btn-primary btn-lg btn-block" type="submit" value="Modifiy banlist" name="Submit" id="redirect_submit" />
                    </form>
                </div>
                {% endif %}
                <!-- END OF Banlist button -->

                <div class="card-text">
                    <form method="POST" action="{% url 'search.process' user_id=user_id gameprofile_id=gameprofile.id %}">
                    {% csrf_token %}

                    <div class="form-group row">
                        <label for="amount" class="col-sm-2 col-form-label col-form-label-lg">Skill range</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control form-control-lg" id="amount" name="amount" readonly style="border:0; color:#f6931f; font-weight:bold;">
                        </div>
                        <div id="slider-range" style="margin-bottom: 10px; width: 25%;"></div>
                    </div>
                    <input type="hidden" id="skill_min" name="skill_min"/>
                    <input type="hidden" id="skill_max" name="skill_max"/>

                    <div class="form-group row">
                        <label for="input_hour_begin" class="col-sm-2 col-form-label col-form-label-lg">Hour (begin)</label>
                        <div class="col-sm-10">
                            <input type="time" class="form-control form-control-lg" id="input_hour_begin" name="input_hour_begin" min="0:00" max="24:00" required>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label for="input_hour_end" class="col-sm-2 col-form-label col-form-label-lg">Hour (end)</label>
                        <div class="col-sm-10">
                            <input type="time" class="form-control form-control-lg" id="input_hour_end" name="input_hour_end" min="0:00" max="24:00" required>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label for="input_date" class="col-sm-2 col-form-label col-form-label-lg">Date</label>
                        <div class="col-sm-10">
                            <input type="date" class="form-control form-control-lg" id="input_date" name="input_date" min="2019-01-01" required>
                        </div>
                    </div>

                    <blockquote class="blockquote mb-0">
                        <button class="btn btn-primary btn-lg" type="submit">Search !</button>
                    </blockquote>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <script>
        // FROM : https://stackoverflow.com/a/13052187
        Date.prototype.toDateInputValue = (function() {
            var local = new Date(this);
            local.setMinutes(this.getMinutes() - this.getTimezoneOffset());
            return local.toJSON().slice(0,10);
        });
        $('#input_date').val(new Date().toDateInputValue());
    </script>
    {% else %}
        <p>You are not logged in</p>
        <a href="{% url 'login' %}">login</a>
    {% endif %}
{% endblock %}